#!/usr/bin/env bash

source project.conf

SOURCE_FILES="source/server/main.c source/server/net.c source/server/clients.c
source/common/math.c"
BINARY=$OUTPUT_DIR/vndf-server

BINARY_NAME=$(basename $BINARY)

function updateServer() {
	./scripts/zwobot/zwobot-compile "$SOURCE_FILES" "" "" $BINARY

	killall $BINARY_NAME

	./$BINARY &
	PID=$!
}

updateServer
while inotifywait -qq -e modify $SOURCE_FILES; do
	echo "Change detected."
	updateServer
done
