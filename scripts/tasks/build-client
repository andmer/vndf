#!/usr/bin/env bash

source project.conf

STATIC_LIBS="\
$OUTPUT_LIB/libglfw3.a \
$OUTPUT_LIB/libfreetype.a \
$OUTPUT_LIB/stb_image.o \
$OUTPUT_LIB/stb_truetype.o \
$OUTPUT_LIB/vec.o"

LIB_ARGS="-lGL -lX11 -lXxf86vm -lpthread -lXrandr -lXi"

rustc -c -o output/lib/vec.o source/rust/common/vec.rs
./scripts/zwobot/zwobot-compile \
	"$CLIENT_SOURCE" "$STATIC_LIBS" "$LIB_ARGS" $CLIENT_BINARY

rm $CLIENT_DIST_DIR/fonts; ln -s $(pwd)/source/fonts $CLIENT_DIST_DIR/fonts
rm $CLIENT_DIST_DIR/images; ln -s $(pwd)/source/images $CLIENT_DIST_DIR/images

cp -r source/config/server $CLIENT_DIST_DIR
